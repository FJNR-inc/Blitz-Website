<div class="profile-page" *ngIf="profile">
  <div class="profile-page__header">
    <div class="profile-page__header__informations">
      <div class="profile-page__header__informations__name">
        {{profile.first_name}} {{profile.last_name}}
        <a class="profile-page__header__informations__name__edit button" [appMyModalOpen]="'form_user'">
          <i class="fas fa-pencil-alt"></i> Éditer mon profil
        </a>
      </div>
      <div class="profile-page__header__informations__email">
        <i class="fas fa-envelope"></i> {{profile.email}}
      </div>
      <div class="profile-page__header__informations__university" *ngIf="profile.university">
        {{profile.university.name}}<br/>
        {{ profile.academic_level.name }} ({{ profile.academic_field.name }})
      </div>
    </div>
    <div class="profile-page__header__right">
      <div class="profile-page__header__right__status">
        <div class="profile-page__header__right__status__main">
          {{profile.tickets || 0}}
        </div>
        ticket(s) disponible(s)
      </div>
      <div class="profile-page__header__right__status" *ngIf="profile.membership_end">
        <div class="profile-page__header__right__status__main">
          {{ profile.getTimeBeforeEndMembership() }}
        </div>
        jours restants<br/>
        (Membership {{ profile.membership.name }})
      </div>
    </div>
  </div>
  <div class="profile-page__sections">
    <app-my-table [settings]="settings"
                  [data]="listReservations"
                  (addButton)="OpenModalCreateDomain()"
                  (editItem)="OpenModalEditDomain($event)"
                  (removeItem)="removeDomain($event)">
    </app-my-table>
  </div>
  <div class="profile-page__sections">
    <h2>Désactiver mon compte</h2>
    <div>
      Si vous désactivez votre compte:
      <ul>
        <li>vous ne pourrez plus vous connecter sur ce site</li>
        <li>toutes vos réservations seront annulées automatiquement</li>
        <li>certaines de vos informations personnelles pourraient être supprimées</li>
      </ul>
      <a class="button button--danger" [appMyModalOpen]="'form_deactivate_account'">
        <i class="fas fa-trash-alt"></i> Désactiver mon compte
      </a>
    </div>
  </div>
</div>

<app-my-modal name="form_deactivate_account"
              typeModal="danger"
              title="Désactiver mon compte"
              button2Label="Désactiver"
              (button2)="deactivateAccount()">
  La désactivation de votre compte est un acte important et irréversible.<br/>
  Êtes-vous vraiment sûr de vouloir désactiver votre compte ?
</app-my-modal>

<app-my-modal name="form_user"
              typeModal="success"
              title="Editer mon profil"
              button2Label="Editer"
              (button2)="submitProfile()">
  <form [formGroup]="userForm" *ngIf="userForm">
    <div *ngFor="let error of userErrors" class="alert alert--danger">
      {{ error }}
    </div>

    <div class="form-group">
      <label for="first_name" class="form-label">Nom:</label>
      <input formControlName="first_name" class="form-input" id="first_name" type="text">
      <div class="form-text form-text--right form-text--danger"
           *ngFor="let errorMessage of userForm.controls['first_name'].getError('apiError')">
        {{ errorMessage}}
      </div>
    </div>
    <div class="form-group">
      <label for="last_name" class="form-label">Prenom:</label>
      <input formControlName="last_name" class="form-input" id="last_name" type="text">
      <div class="form-text form-text--right form-text--danger"
           *ngFor="let errorMessage of userForm.controls['last_name'].getError('apiError')">
        {{ errorMessage}}
      </div>
    </div>
    <div class="form-group">
      <label for="birthdate" class="form-label">Date de naissance:</label>
      <input [owlDateTimeTrigger]="dt_end"
             [owlDateTime]="dt_end"
             formControlName="birthdate"
             class="form-input"
             id="birthdate">
      <owl-date-time #dt_end [firstDayOfWeek]="1" pickerType="calendar"></owl-date-time>
      <div class="form-text form-text--right form-text--danger"
           *ngFor="let errorMessage of userForm.controls['birthdate'].getError('apiError')">
        {{ errorMessage}}
      </div>
    </div>
    <div class="form-group">
      <label for="gender" class="form-label">Genre:</label>
      <select formControlName="gender" id="gender" class="form-input">
        <option value="A">Je ne souhaite pas m'identifie</option>
        <option value="M">Homme</option>
        <option value="F">Femme</option>
        <option value="T">Trans</option>
      </select>
      <div class="form-text form-text--right form-text--danger"
           *ngFor="let errorMessage of userForm.controls['gender'].getError('apiError')">
        {{ errorMessage}}
      </div>
    </div>
  </form>
</app-my-modal>
